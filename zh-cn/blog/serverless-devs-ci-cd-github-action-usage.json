{
  "filename": "serverless-devs-ci-cd-github-action-usage.md",
  "__html": "<h1 id=\"%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87github-action%E4%BD%BF%E7%94%A8serverless-devs%E5%81%9Aci%2Fcd\">å¦‚ä½•é€šè¿‡Github Actionä½¿ç”¨Serverless DevsåšCI/CD <a class=\"header-anchor\" href=\"#%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87github-action%E4%BD%BF%E7%94%A8serverless-devs%E5%81%9Aci%2Fcd\">#</a></h1>\n<p>å½“æˆ‘ä»¬åœ¨ä½“éªŒServerlessä¹‹åï¼Œæ¬²å°†é¡¹ç›®çœŸçœŸå®å®çš„éƒ¨ç½²åˆ°Serverlessæ¶æ„æ—¶ï¼ŒCI/CDæ˜¯æˆ‘ä»¬å¾ˆå¤šäººç»•ä¸å¼€çš„è¯é¢˜ï¼Œé‚£ä¹ˆåŸºäºServerless Devsè¿™æ¬¾å·¥å…·ï¼Œå¦‚ä½•å¿«é€Ÿçš„å’ŒGithub Actionè¿›è¡Œæœ‰æœºç»“åˆï¼Œå®ç°CI/CDçš„èƒ½åŠ›å‘¢ï¼Ÿ</p>\n<h2 id=\"ci%2Fcd%E7%9A%84%E2%80%9C%E8%84%9A%E6%89%8B%E6%9E%B6%E2%80%9D\">CI/CDçš„â€œè„šæ‰‹æ¶â€ <a class=\"header-anchor\" href=\"#ci%2Fcd%E7%9A%84%E2%80%9C%E8%84%9A%E6%89%8B%E6%9E%B6%E2%80%9D\">#</a></h2>\n<p>ç°åœ¨æœ‰å¾ˆå¤šçš„è„šæ‰‹æ¶ï¼Œä½†æ˜¯Serverless CI/CDçš„è„šæ‰‹æ¶åº”è¯¥è¿˜æ˜¯å°‘æ•°çš„ï¼Œè€ŒServerless Devsä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªCI/CDçš„è„šæ‰‹æ¶ï¼Œä»¥Github Actionä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œä»£ç ï¼Œå¿«é€Ÿåœ¨é¡¹ç›®ä¸‹åˆå§‹åŒ–CI/CDæ¨¡æ¿ã€‚</p>\n<p>ä¾‹å¦‚ï¼Œå½“å‰æˆ‘çš„é¡¹ç›®ç»“æ„ï¼š</p>\n<p><img src=\"https://user-images.githubusercontent.com/21079031/120759969-27bccf80-c546-11eb-9260-64724df2e5f5.png\" alt=\"image\"></p>\n<p>æ­¤æ—¶ï¼Œæˆ‘åªéœ€è¦å‘Šè¯‰Serverless Devsï¼Œæˆ‘è¦ç”Ÿæˆä¸€ä¸ªGithub Actionæ¨¡æ¿å³å¯ï¼š</p>\n<pre><code>s cli cicd github\n</code></pre>\n<p><img src=\"https://user-images.githubusercontent.com/21079031/120760086-48852500-c546-11eb-9c38-66dbfd82e632.png\" alt=\"image\"></p>\n<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç³»ç»Ÿä¼šåœ¨å½“å‰é¡¹ç›®åˆ›å»ºç›¸å¯¹åº”çš„CI/CDæ¨¡æ¿ï¼š</p>\n<p><img src=\"https://user-images.githubusercontent.com/21079031/120760172-681c4d80-c546-11eb-9551-ba3e060e2947.png\" alt=\"image\"></p>\n<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº†ç¬¬ä¸€ä¸ªæ­¥éª¤ï¼Œåˆå§‹åŒ–ä¸€ä¸ªCI/CDçš„æ¨¡æ¿ã€‚</p>\n<h2 id=\"%E6%B5%81%E7%A8%8B%E9%85%8D%E7%BD%AE\">æµç¨‹é…ç½® <a class=\"header-anchor\" href=\"#%E6%B5%81%E7%A8%8B%E9%85%8D%E7%BD%AE\">#</a></h2>\n<h3 id=\"yml%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE\">Ymlæ–‡ä»¶é…ç½® <a class=\"header-anchor\" href=\"#yml%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE\">#</a></h3>\n<p>ç³»ç»Ÿæ‰€ä¸ºæˆ‘ä»¬ç”Ÿæˆçš„æ¨¡æ¿æ–‡ä»¶å®é™…ä¸Šæ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„æ¡ˆä¾‹ï¼š</p>\n<pre><code class=\"language-yaml\"><span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Serverless</span> <span class=\"hljs-string\">Devs</span> <span class=\"hljs-string\">Project</span> <span class=\"hljs-string\">CI/CD</span>\n\n<span class=\"hljs-attr\">on:</span>\n  <span class=\"hljs-attr\">push:</span>\n    <span class=\"hljs-attr\">branches:</span> <span class=\"hljs-string\">[</span> <span class=\"hljs-string\">master</span> <span class=\"hljs-string\">]</span>\n\n<span class=\"hljs-attr\">jobs:</span>\n  <span class=\"hljs-attr\">serverless-devs-cd:</span>\n    <span class=\"hljs-attr\">runs-on:</span> <span class=\"hljs-string\">ubuntu-latest</span>\n    <span class=\"hljs-attr\">steps:</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/checkout@v2</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/setup-node@v2</span>\n        <span class=\"hljs-attr\">with:</span>\n          <span class=\"hljs-attr\">node-version:</span> <span class=\"hljs-number\">12</span>\n          <span class=\"hljs-attr\">registry-url:</span> <span class=\"hljs-string\">https://registry.npmjs.org/</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">npm</span> <span class=\"hljs-string\">install</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">npm</span> <span class=\"hljs-string\">install</span> <span class=\"hljs-string\">-g</span> <span class=\"hljs-string\">@serverless-devs/s</span>\n      <span class=\"hljs-comment\"># é»˜è®¤å¯†é’¥é…ç½®æŒ‡ä»¤æ˜¯é˜¿é‡Œäº‘å¯†é’¥é…ç½®æŒ‡ä»¤ï¼Œæ›´å¤šå¯ä»¥å‚è€ƒï¼š</span>\n      <span class=\"hljs-comment\"># å¦‚ä½•é€šè¿‡Github Actionä½¿ç”¨Serverless DevsåšCI/CDï¼šhttp://short.devsapp.cn/cicd/github/action/usage</span>\n      <span class=\"hljs-comment\"># Serverless Devsçš„å®˜ç½‘æ˜¯é€šè¿‡Serverless Devséƒ¨ç½²çš„: http://short.devsapp.cn/cicd/github/action/practice</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">s</span> <span class=\"hljs-string\">config</span> <span class=\"hljs-string\">add</span> <span class=\"hljs-string\">--AccountID</span> <span class=\"hljs-string\">${{secrets.AccountID}}</span> <span class=\"hljs-string\">--AccessKeyID</span> <span class=\"hljs-string\">${{secrets.AccessKeyID}}</span> <span class=\"hljs-string\">--AccessKeySecret</span> <span class=\"hljs-string\">${{secrets.AccessKeySecret}}</span> <span class=\"hljs-string\">-a</span> <span class=\"hljs-string\">default</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">s</span> <span class=\"hljs-string\">deploy</span>\n</code></pre>\n<p>æ•´ä¸ªæ ¸å¿ƒæµç¨‹æ˜¯ï¼š</p>\n<ol>\n<li>ä¸‹è½½<code>serverless-devs</code></li>\n<li>é…ç½®å¯†é’¥ä¿¡æ¯</li>\n<li>é¡¹ç›®éƒ¨ç½²ï¼ˆæ‰§è¡Œ<code>s deploy</code>å‘½ä»¤ï¼‰</li>\n</ol>\n<p>ä½†æ˜¯åœ¨å®é™…ç”Ÿäº§è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦è‡ªå®šä¹‰ä½¿ç”¨ä¸€äº›åŠŸèƒ½ï¼Œæ­¤æ—¶å¯ä»¥å‚è€ƒGithub Actionçš„æ–‡æ¡£ï¼š<a href=\"https://docs.github.com/cn/actions\">https://docs.github.com/cn/actions</a></p>\n<p>ä¾‹å¦‚ï¼Œæˆ‘åœ¨ä¸‹è½½<code>serverless-devs</code>ä¹‹åï¼Œé…ç½®å¯†é’¥ä¹‹åï¼Œæˆ‘éœ€è¦è¿›è¡Œ<code>build</code>ç­‰æ“ä½œï¼Œæ“ä½œä¹‹åï¼Œæˆ‘åœ¨åˆ é™¤ä¸´æ—¶ç”Ÿæˆçš„æ–‡ä»¶å¤¹&quot;./abc&quot;ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥ï¼š</p>\n<pre><code class=\"language-yaml\"><span class=\"hljs-string\">...</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">npm</span> <span class=\"hljs-string\">install</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">npm</span> <span class=\"hljs-string\">install</span> <span class=\"hljs-string\">-g</span> <span class=\"hljs-string\">@serverless-devs/s</span>\n      <span class=\"hljs-comment\"># é»˜è®¤å¯†é’¥é…ç½®æŒ‡ä»¤æ˜¯é˜¿é‡Œäº‘å¯†é’¥é…ç½®æŒ‡ä»¤ï¼Œæ›´å¤šå¯ä»¥å‚è€ƒï¼š</span>\n      <span class=\"hljs-comment\"># å¦‚ä½•é€šè¿‡Github Actionä½¿ç”¨Serverless DevsåšCI/CDï¼šhttp://short.devsapp.cn/cicd/github/action/usage</span>\n      <span class=\"hljs-comment\"># Serverless Devsçš„å®˜ç½‘æ˜¯é€šè¿‡Serverless Devséƒ¨ç½²çš„: http://short.devsapp.cn/cicd/github/action/practice</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">s</span> <span class=\"hljs-string\">config</span> <span class=\"hljs-string\">add</span> <span class=\"hljs-string\">--AccountID</span> <span class=\"hljs-string\">${{secrets.AccountID}}</span> <span class=\"hljs-string\">--AccessKeyID</span> <span class=\"hljs-string\">${{secrets.AccessKeyID}}</span> <span class=\"hljs-string\">--AccessKeySecret</span> <span class=\"hljs-string\">${{secrets.AccessKeySecret}}</span> <span class=\"hljs-string\">-a</span> <span class=\"hljs-string\">default</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">s</span> <span class=\"hljs-string\">build</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">rm</span> <span class=\"hljs-string\">-rf</span> <span class=\"hljs-string\">./abc</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">s</span> <span class=\"hljs-string\">deploy</span>\n</code></pre>\n<p>æ‰€ä»¥ï¼Œå…·ä½“çš„æµç¨‹ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥æ ¹æ®éœ€æ±‚è‡ªå®šä¹‰ã€‚</p>\n<h3 id=\"%E8%B4%A6%E5%8F%B7%E4%BF%A1%E6%81%AF%E9%85%8D%E7%BD%AE\">è´¦å·ä¿¡æ¯é…ç½® <a class=\"header-anchor\" href=\"#%E8%B4%A6%E5%8F%B7%E4%BF%A1%E6%81%AF%E9%85%8D%E7%BD%AE\">#</a></h3>\n<p>åœ¨ä¸Šä¸€ä¸ªæµç¨‹ä¸­ï¼Œæˆ‘ä»¬æ¶‰åŠåˆ°å¯†é’¥ä¿¡æ¯çš„é…ç½®ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Serverless Devsä¸ºæˆ‘ä»¬æä¾›çš„<code>s config add</code>å‘½ä»¤è¿›è¡Œã€‚</p>\n<p>ä¾‹å¦‚ï¼Œé˜¿é‡Œäº‘çš„è´¦å·ä½“ç³»éœ€è¦<code>AccountID</code>,<code>AccessKeyID</code>,<code>AccessKeySecret</code>ç­‰å†…å®¹ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥ï¼š</p>\n<ol>\n<li>å°†å¯†é’¥ä¿¡æ¯é…ç½®åˆ°Github Secretsä¸­</li>\n</ol>\n<p><img src=\"https://user-images.githubusercontent.com/21079031/120761131-71f28080-c547-11eb-9bb8-e08dafabb4ee.png\" alt=\"image\"></p>\n<p>æˆ‘ä»¬åˆ›å»ºå¤šå¯¹å¯†é’¥ä¿¡æ¯ï¼š</p>\n<p><img src=\"https://user-images.githubusercontent.com/21079031/120761249-93ec0300-c547-11eb-9c0d-904fb85b4201.png\" alt=\"image\"></p>\n<p>ä¾‹å¦‚ï¼Œæˆ‘æ­¤å¤„é…ç½®äº†ä¸‰å¯¹å¯†é’¥ï¼š</p>\n<ul>\n<li><code>ALIYUN_ACCOUNT_ID</code>å¯¹åº”é˜¿é‡Œäº‘å¯†é’¥ä½“ç³»ä¸­çš„<code>AccountID</code>ï¼›</li>\n<li><code>ALIYUN_ACCESS_KEY_ID</code>å¯¹åº”é˜¿é‡Œäº‘å¯†é’¥ä½“ç³»ä¸­çš„<code>AccessKeyID</code>ï¼›</li>\n<li><code>ALIYUN_ACCESS_KEY_SECRET</code>å¯¹åº”é˜¿é‡Œäº‘å¯†é’¥ä½“ç³»ä¸­çš„<code>AccessKeySecret</code></li>\n</ul>\n<p><img src=\"https://user-images.githubusercontent.com/21079031/120761347-ae25e100-c547-11eb-9bcd-4fc742671bc5.png\" alt=\"image\"></p>\n<p>æˆ‘æ­¤æ—¶åˆ™å¯ä»¥å¯¹åº”é…ç½®ï¼š</p>\n<pre><code>s config add --AccountID ${{secrets.ALIYUN_ACCOUNT_ID}} --AccessKeyID ${{secrets.ALIYUN_ACCESS_KEY_ID}} --AccessKeySecret ${{secrets.ALIYUN_ACCESS_KEY_SECRET}} -a website_access\n</code></pre>\n<p>å½“ç„¶ï¼Œä¸åŒå‚å•†å¯èƒ½éœ€è¦ä¸åŒçš„å¯†é’¥ä¿¡æ¯é…ç½®ï¼Œéƒ¨åˆ†æƒ…å†µä¸‹å‚å•†å¯èƒ½è¿˜éœ€è¦é…ç½®ä¸´æ—¶å¯†é’¥ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡<code>s config add -h</code>è·å–å¯†é’¥é…ç½®çš„å¸®åŠ©æ–‡æ¡£ï¼š</p>\n<pre><code>jiangyu@ServerlessSecurity ~ % s config add -h\nUsage: s config add [commands] [name]\n\nYou can add an account\n\n    Example:\n        $ s config add\n        $ s config add --AccessKeyID ****** --AccessKeySecret ****** --AccountID ******\n        $ s config add --AccessKey ****** --SecretKey ******\n  \n    Configuration parameters for cloud vendors:\n        alibaba: AccountID, AccessKeyID, AccessKeySecret\n        aws: AccessKeyID, SecretAccessKey\n        baidu: AccessKeyID, SecretAccessKey\n        huawei: AccessKey, SecretKey\n        google: PrivateKeyData\n        tencent: AccountID, SecretID, SecretKey\n\nğŸ§­ How to get the key: https://github.com/Serverless-Devs/docs/tree/master/zh/others/provider-config\n\nOptions:\n  --AccountID [AccountID]              AccountID of key information\n  --AccessKeyID [AccessKeyID]          AccessKeyID of key information\n  --AccessKeySecret [AccessKeySecret]  AccessKeySecret of key information\n  --SecretAccessKey [SecretAccessKey]  SecretAccessKey of key information\n  --AccessKey [AccessKey]              AccessKey of key information\n  --SecretKey [SecretKey]              SecretKey of key information\n  --SecretID [SecretID]                SecretID of key information\n  --PrivateKeyData [PrivateKeyData]    PrivateKeyData of key information\n  -kl , --keyList [keyList]            Keys of key information, like: -kl key1,key2,key3\n  -il , --infoList [infoList]          Values of key information, like: -kl info1,info2,info3\n  -a , --aliasName [name]              Key pair alias, if the alias is not set, use default instead\n  -h, --help                           Display help for command\n</code></pre>\n<blockquote>\n<p>å¦‚ä½•é…ç½®è‡ªå®šä¹‰Key-Valueçš„å¯†é’¥ï¼Œä¾‹å¦‚æŸä¸ªç»„ä»¶æ˜¯æˆ‘è‡ªå·±å¼€å‘çš„ï¼Œæˆ‘éœ€è¦é…ç½®ä¸€ä¸ªKeyä¸ºtempToken1ï¼ŒValueä¸ºtempValue1ï¼Œå’ŒKeyä¸ºtempToken2ï¼ŒValueä¸ºtempValue2ï¼Œåˆ«åä¸ºdemoçš„å¯†é’¥å¯¹ï¼Ÿ\næ­¤æ—¶å¯ä»¥é€šè¿‡å‚æ•°<code>-kl , --keyList [keyList]</code>å’Œ<code>-il , --infoList [infoList]</code>è‡ªå®šä¹‰æ·»åŠ ï¼Œä¾‹å¦‚ï¼š<code>s config add -kl tempToken1,tempToken2 -il tempValue1,tempValue2 -a demo</code>\n<img src=\"https://user-images.githubusercontent.com/21079031/120762289-adda1580-c548-11eb-9684-87767b6fe109.png\" alt=\"image\"></p>\n</blockquote>\n<blockquote>\n<p>å¯†é’¥ä¸­çš„åˆ«åæœ‰ä»€ä¹ˆï¼Ÿ\nå¯†é’¥ä¸­çš„åˆ«åï¼Œæ˜¯ä¸ºäº†å¸®åŠ©Serverless Devsæ›´å¿«çš„è¯†åˆ«å‡ºä½ è¦ç”¨çš„å¯†é’¥ä¿¡æ¯ï¼Œä¸»è¦æ˜¯åœ¨Yamlä¸­ä½“ç°ï¼Œä¾‹å¦‚ï¼š\n<img src=\"https://user-images.githubusercontent.com/21079031/120762524-eb3ea300-c548-11eb-83ec-73dabc2029c9.png\" alt=\"image\">\nåœ¨æ­¤å¤„é…ç½®çš„å¯†é’¥ä¿¡æ¯ï¼ˆé»˜è®¤æ˜¯defaultï¼‰ï¼Œå¦‚æœæ­¤å¤„é…ç½®äº†å¯†é’¥åˆ«åæ˜¯&quot;default&quot;ï¼Œé‚£ä¹ˆç³»ç»Ÿå°±ä¼šåœ¨æ‰§è¡Œç›¸å…³æ“ä½œçš„æ—¶å€™ï¼Œå»è·å–åä¸º&quot;default&quot;çš„å¯†é’¥ä¿¡æ¯ï¼›</p>\n</blockquote>\n<blockquote>\n<p>æˆ‘çš„ä¸€ä¸ªåº”ç”¨ä¸­ï¼Œæ¶‰åŠåˆ°éƒ¨ç½²åˆ°å¤šä¸ªå¹³å°ï¼Œéœ€è¦å¤šä¸ªå¯†é’¥ä¿¡æ¯ï¼Œå¦‚ä½•é…ç½®ï¼Ÿ<br>\nä¾‹å¦‚ï¼Œå½“å­˜åœ¨é¡¹ç›®ï¼š\n<img src=\"https://user-images.githubusercontent.com/21079031/120762886-45d7ff00-c549-11eb-8d01-743ad858d611.png\" alt=\"image\">\næ­¤æ—¶ï¼Œè¯¥appä¸­æ¶‰åŠåˆ°ä¸¤ä¸ªServiceï¼Œåˆ†åˆ«ç”¨äº†ä¸åŒçš„ç»„ä»¶ä»¥åŠä¸åŒçš„å¯†é’¥å†…å®¹<code>website_access</code>, <code>fc_access</code><br>\næˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®å¤šä¸ªå¯†é’¥ä¿¡æ¯æ¥è¿›è¡ŒCI/CDçš„é…ç½®</p>\n<ol>\n<li>åœ¨Github Secretså¤„é…ç½®å¯¹åº”çš„Key-Value</li>\n<li>åœ¨ç”Ÿæˆçš„<code>.github/workflow/serverless-devs.yml</code>æ–‡ä»¶ä¸­é…ç½®å¯†é’¥ä¿¡æ¯ï¼š</li>\n</ol>\n<pre><code>s config add -kl tempToken1,tempToken2 -il tempValue1,tempValue2 -a website_access\ns config add -kl tempToken3,tempToken4 -il tempValue3,tempValue4 -a fc_access\n</code></pre>\n</blockquote>\n<h1 id=\"others\">Others <a class=\"header-anchor\" href=\"#others\">#</a></h1>\n<p>Best practicesï¼š</p>\n<ul>\n<li>ğŸ‰ Serverless Devsçš„å®˜ç½‘æ˜¯é€šè¿‡Serverless Devséƒ¨ç½²çš„: <a href=\"http://short.devsapp.cn/cicd/github/action/practice\">http://short.devsapp.cn/cicd/github/action/practice</a></li>\n</ul>\n",
  "link": "/zh-cn/blog/serverless-devs-ci-cd-github-action-usage.html",
  "meta": {
    "slug": "serverless-devs-ci-cd-github-action-usage",
    "title": "å¦‚ä½•é€šè¿‡Github Actionä½¿ç”¨Serverless DevsåšCI/CD",
    "author": "Anycodes",
    "author_title": "Serverless Devs",
    "author_url": "https://github.com/anycodes",
    "author_image_url": "https://avatars.githubusercontent.com/u/21079031?v=4",
    "tags": "[å‘½ä»¤è¡Œ, Serverless, CI/CD]",
    "date": "2021-06-04"
  }
}