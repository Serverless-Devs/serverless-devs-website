<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="keywords" content="Serverless Devs 配置,yaml" />
	<meta name="description" content="ServerlessDevs 配置规范" />
	<!-- 网页标签标题 -->
	<title>ServerlessDevs 配置规范</title>
	<link rel="shortcut icon" href="/img/docsite.ico"/>
	<link rel="stylesheet" href="/build/documentation.css" />
</head>
<body>
	<div id="root"><div class="documentation-page" data-reactroot=""><header class="header-container header-container-normal"><a href="/zh-cn/index.html" class="logo-link"><img class="logo" src="/img/sdLogoblack.png"/></a><div class="header-body"><div class="header-menu"><img class="header-menu-toggle" src="/img/system/menu_gray.png"/><ul><li class="menu-item menu-item-normal"><div class="nav-container"><a href="/zh-cn/products/index.html"><div class="word">产品</div></a><ul class="sub-nav-container" style="width:220px"><li><a href="/zh-cn/desktop/index.html" target="_blank" style="display:block;width:100%;height:100%">Serverless Desktop</a></li><li><a href="/zh-cn/cli/index.html" target="_blank" style="display:block;width:100%;height:100%">Serverless Cli</a></li><li><a href="https://serverlesshub.resume.net.cn?spm=serverlessdevs.topbar.0.0.0" target="_blank" style="display:block;width:100%;height:100%">Serverless Hub</a></li></ul> </div></li><li class="menu-item menu-item-normal"><div class="nav-container"><a href="/zh-cn/developer/index.html"><div class="word">开发者</div></a><ul class="sub-nav-container" style="width:220px"><li><a href="/zh-cn/docs/overview/intro.html" target="_blank" style="display:block;width:100%;height:100%">文档</a></li><li><a href="/zh-cn/docs/quickstart/desktop-quickstart.html" target="_blank" style="display:block;width:100%;height:100%">快速开始</a></li><li><a href="https://github.com/Serverless-Devs/Serverless-Devs/discussions" target="_blank" style="display:block;width:100%;height:100%">社区活动</a></li><li><a href="https://github.com/Serverless-Devs/Serverless-Devs" target="_blank" style="display:block;width:100%;height:100%">开源</a></li></ul> </div></li><li class="menu-item menu-item-normal"><span><a href="https://serverlesshub.resume.net.cn?spm=serverlessdevs.topbar.0.0.0" target="_blank">应用中心</a></span></li><li class="menu-item menu-item-normal"><div class="nav-container"><a href=""><div class="word">企业级Serverless解决方案</div></a><ul class="sub-nav-container" style="width:220px"><li><a href="https://www.aliyun.com/product/fc?spm=serverlessdevs..topbar.0.0.0" target="_blank" style="display:block;width:100%;height:100%">函数计算 FC</a></li><li><a href="https://www.aliyun.com/product/aliware/sae?spm=serverlessdevs..topbar.0.0.0" target="_blank" style="display:block;width:100%;height:100%">Serverless 应用引擎</a></li></ul> </div></li><li class="menu-item menu-item-normal"><span><a href="/zh-cn/blog/index.html">博客</a></span></li><li class="menu-item menu-item-normal"><span><a href="https://github.com/Serverless-Devs/Serverless-Devs/discussions" target="_blank">社区</a></span></li></ul></div><div class="header-more-action"><div style="float:right" class="get-start"><a class="button button-primary" target="_self" href="/zh-cn/developer/index.html">开始使用</a></div><div class="search search-normal"><span class="icon-search"></span></div></div></div></header><div class="bar"><div class="bar-body"><img src="/img/system/docs.png" class="front-img"/><span>文档</span><img src="/img/system/docs.png" class="back-img"/></div></div><section class="content-section"><div class="sidemenu"><div class="sidemenu-toggle"><img src="https://img.alicdn.com/tfs/TB1E6apXHGYBuNjy0FoXXciBFXa-200-200.png"/></div><ul><li class="menu-item menu-item-level-1"><span>概述</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/overview/intro.html" target="_self">ServerlessDevs是什么</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/overview/terminology.html" target="_self">术语表</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/overview/faq.html" target="_self">FAQ</a></li></ul></li><li class="menu-item menu-item-level-1"><span>快速开始</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/installed/desktopinstall.html" target="_self">Serverless Desktop 安装指引</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/installed/cliinstall.html" target="_self">Serverless Cli 安装指引</a></li></ul></li><li class="menu-item menu-item-level-1"><span>最佳实践</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/best-practice/jamstack.html" target="_self">快速构建Jamstack站点</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/best-practice/restful.html" target="_self">Restful API 实现</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/best-practice/ssr.html" target="_self">Nuxt实现SSR方案</a></li></ul></li><li class="menu-item menu-item-level-1"><span>用户文档</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/user/yaml.html" target="_self">配置规范说明</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/user/registry.html" target="_self">源规范说明</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>秘钥配置介绍<img style="transform:rotate(-90deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/provider-config/alibabacloud.html" target="_self">阿里云秘钥获取</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/provider-config/aws.html" target="_self">AWS秘钥获取</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/provider-config/azure.html" target="_self">Azure秘钥获取</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/provider-config/baiducloud.html" target="_self">百度云秘钥获取</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/provider-config/gcp.html" target="_self">Google Cloud秘钥获取</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/provider-config/huawei.html" target="_self">华为云秘钥获取</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/provider-config/tencentcloud.html" target="_self">腾讯云秘钥获取</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/user/app-template.html" target="_self">应用模板介绍</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/user/component.html" target="_self">组件说明</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/user/app.html" target="_self">应用说明</a></li></ul></li><li class="menu-item menu-item-level-1"><span>成为贡献者</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/contributor/overview.html" target="_self">如何成为贡献者</a></li></ul></li><li class="menu-item menu-item-level-1"><span>Serverless Devs Cli使用指南</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/cli/init.html" target="_self">命令行使用介绍</a></li></ul></li><li class="menu-item menu-item-level-1"><span>Serverless Desktop使用指南</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/desktop/access-config.html" target="_self">秘钥信息配置</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/desktop/config.html" target="_self">可视化配置介绍</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/desktop/workspace.html" target="_self">工作空间介绍</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/desktop/debug.html" target="_self">端云调试介绍</a></li></ul></li></ul></div><div class="doc-content markdown-body"><h1 id="serverlessdevs-%E9%85%8D%E7%BD%AE%E8%A7%84%E8%8C%83">ServerlessDevs 配置规范 <a class="header-anchor" href="#serverlessdevs-%E9%85%8D%E7%BD%AE%E8%A7%84%E8%8C%83">#</a></h1>
<p>Serverless Devs是可以通过Yaml进行资源描述的，我们也是推荐使用者通过Yaml进行资源和行为的管理。</p>
<p>Serverless Devs Cli可以识别的Yaml默认文件为<code>s.yaml</code>/<code>s.yml</code>，使用者也可以通过<code>-t/--template</code>来进行其他名称的Yaml文件的指定，Serverless Devs Cli可识别的Yaml规范格式整体为：</p>
<pre><code class="language-yaml"><span class="hljs-attr">edition:</span> <span class="hljs-number">1.0</span><span class="hljs-number">.0</span>        <span class="hljs-comment">#  命令行YAML规范版本，遵循语义化版本（Semantic Versioning）规范</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">FullStack</span>       <span class="hljs-comment">#  项目名称</span>
<span class="hljs-attr">access:</span> <span class="hljs-string">xxx-account1</span>  <span class="hljs-comment">#  秘钥别名</span>

<span class="hljs-attr">vars:</span> <span class="hljs-comment"># [全局变量，提供给各个服务使用]</span>
  <span class="hljs-attr">logo:</span> <span class="hljs-string">https://image.aliyun.com/xxxx.png</span>
  <span class="hljs-attr">domain:</span> <span class="hljs-string">xxxx.yyy.com</span>

<span class="hljs-attr">services:</span>
  <span class="hljs-attr">nextjs-portal:</span> <span class="hljs-comment">#  服务名称</span>
    <span class="hljs-attr">access:</span> <span class="hljs-string">xxx-account1</span>  <span class="hljs-comment">#  秘钥别名，如果和项目的access相同，可省略</span>
    <span class="hljs-attr">component:</span> <span class="hljs-string">vue-component</span>  <span class="hljs-comment"># 组件名称</span>
    <span class="hljs-attr">props:</span> <span class="hljs-comment">#  组件的属性值</span>
      <span class="hljs-attr">src:</span> <span class="hljs-string">./frontend_src</span>
      <span class="hljs-attr">url:</span> <span class="hljs-string">url</span>
    <span class="hljs-attr">actions:</span> <span class="hljs-comment"># 自定义执行逻辑</span>
      <span class="hljs-attr">pre-deploy:</span> <span class="hljs-comment"># 在deploy之前运行</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">run:</span> <span class="hljs-string">s</span> <span class="hljs-string">exec</span> <span class="hljs-string">--</span> <span class="hljs-string">publish</span>  <span class="hljs-comment"># 要运行的命令行</span>
          <span class="hljs-attr">path:</span> <span class="hljs-string">./backend_src</span> <span class="hljs-comment"># 命令行运行的路径</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">plugin:</span> <span class="hljs-string">plugin-name</span> <span class="hljs-comment"># 要运行的plugin名称</span>
      <span class="hljs-attr">post-deploy:</span> <span class="hljs-comment"># 在deploy之后运行</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">run:</span> <span class="hljs-string">s</span> <span class="hljs-string">clean</span>
          <span class="hljs-attr">path:</span> <span class="hljs-string">./frontend_src</span>

  <span class="hljs-attr">assets:</span>
    <span class="hljs-attr">component:</span> <span class="hljs-string">static</span>
    <span class="hljs-attr">props:</span>
      <span class="hljs-attr">cache-control:</span> <span class="hljs-string">"public, max-age=604800, immutable"</span>
      <span class="hljs-attr">www:</span> <span class="hljs-string">"./public"</span>

  <span class="hljs-attr">express-blog:</span>
    <span class="hljs-attr">component:</span> <span class="hljs-string">express</span>
    <span class="hljs-attr">props:</span>
      <span class="hljs-attr">app:</span> <span class="hljs-string">./express-blog</span>
      <span class="hljs-attr">url:</span> <span class="hljs-string">${vars.domain}</span>
    <span class="hljs-attr">actions:</span>
      <span class="hljs-attr">pre-deploy:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">build</span>
          <span class="hljs-attr">path:</span> <span class="hljs-string">./express-blog</span>

  <span class="hljs-attr">gateway:</span>
    <span class="hljs-attr">component:</span> <span class="hljs-string">serverless-gateway</span> <span class="hljs-comment"># 路由组件：HTTP URL和服务之间的映射规则</span>
    <span class="hljs-attr">props:</span>
      <span class="hljs-attr">routes:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">route:</span> <span class="hljs-string">/~assets</span>
          <span class="hljs-attr">value:</span> <span class="hljs-string">${assets.output.url}</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">route:</span> <span class="hljs-string">/</span>
          <span class="hljs-attr">value:</span> <span class="hljs-string">${nextjs-portal.output.url}</span>
          <span class="hljs-attr">index:</span> <span class="hljs-string">index.html</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">route:</span> <span class="hljs-string">/~portal</span>
          <span class="hljs-attr">value:</span> <span class="hljs-string">${nextjs-portal.output.url}</span>
          <span class="hljs-attr">inex:</span> <span class="hljs-string">index.html</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">route:</span> <span class="hljs-string">/~blog</span>
          <span class="hljs-attr">value:</span> <span class="hljs-string">${express-blog.output.url}</span>
</code></pre>
<p>Yaml支持的多种变量格式如下：</p>
<ul>
<li>获取当前机器中的环境变量：{env(环境变量)}，例如{env(secretId)}</li>
<li>获取外部文档的变量：{file(路径)}，例如{file(./path)}</li>
<li>获取全局变量：${vars.*}</li>
<li>获取其他项目的变量：${projectName.props.*}</li>
<li>获取Yaml中其他项目的结果变量：${projectName.output.*}</li>
</ul>
<p>当然，如果一个Yaml中有过多的项目，系统也会默认分析部署顺序：</p>
<ol>
<li>分析项目中的依赖关系</li>
<li>有依赖关系的按照依赖关系从前到后部署，无依赖关系的按Yaml配置的从上到下部署</li>
</ol>
</div></section><footer class="footer-container"><div class="footer-body"><div class="cols-container"><div class="col col-12"><h3>愿景</h3><p>Serverless Devs 一款可以在Serverless应用全生命周期发挥作用的开发者工具，致力于打造成为 Serverless 应用开发的基础设施</p></div><div class="col col-6"><dl><dt>文档</dt><dd><a href="/zh-cn/docs/intro.html" target="_self">概览</a></dd><dd><a href="/zh-cn/docs/quickstart/desktop-quickstart.html" target="_self">快速开始</a></dd><dd><a href="/zh-cn/developer/index.html" target="_self">开发者指南</a></dd></dl></div><div class="col col-6"><dl><dt>资源</dt><dd><a href="/zh-cn/blog/index.html" target="_self">博客</a></dd><dd><a href="https://github.com/Serverless-Devs/Serverless-Devs/discussions" target="_self">社区</a></dd></dl></div></div><div class="copyright"><span>Copyright © 2021 Serverless Devs,Inc. Built with docsite</span></div></div></footer></div></div>
	<script src="https://f.alicdn.com/react/15.4.1/react-with-addons.min.js"></script>
	<script src="https://f.alicdn.com/react/15.4.1/react-dom.min.js"></script>
	<script>
		window.rootPath = '';
  </script>
	<script src="/build/documentation.js"></script>
</body>
</html>